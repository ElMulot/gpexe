{% extends 'layout.html.twig' %}

{% set display_serie_select = serie_ids is not empty and project is defined and app.request.query.has('series') is same as(false) %}
{% set display_serie_new = serie_ids is empty and project is defined and app.request.query.all('companies') is defined %}

{% block stylesheets %}
	{{ encore_entry_link_tags('engineering') }}
	{{ parent() }}
{% endblock %}

{% block navbar %}
	{{ include('navbar/_engineering.html.twig') }}
{% endblock %}

{% block main %}
	<div id="engineering" {{ stimulus_controller('engineering--main', {
		'urlHeader': path('engineeringThead', {'project': project.id}),
		'urlBody': path('engineeringTbody', {'project': project.id}),
		'query': app.request.query.all(),
	}) }}>
		<div class="sticky-top">
			{{ include('pages/engineering/index/_nav.html.twig') }}
		</div>
		<turbo-frame id="table" class="table-responsive nav-shown mb-4" data-turbo-append="true"
			{{ stimulus_target('engineering--main', 'tableContainer') }}>
			<table class="table table-sm table-hover table-active" {{ stimulus_target('engineering--main', 'table') }}>
				<thead id="thead" {{ stimulus_target('engineering--main', 'thead') }}>
				
				</thead>
				<tbody id="tbody" {{ stimulus_target('engineering--main', 'tbody') }}>
					
				</tbody>
			</table>
			<div id="navigation" class="d-flex justify-content-center" {{ stimulus_target('engineering--main', 'navigation') }}>
			</div>
		</turbo-frame>
		<div id="request"></div>
	</div>
{% endblock %}

{% block xl_modal %}
	{% if display_serie_new %}
		{% include "modal/xl_modal.html.twig" with {'src': path('serieNew', {'project': project.id}|merge(app.request.query))} %}
	{% elseif display_serie_select %}
		{% include "modal/xl_modal.html.twig" with {'src': path('serieSelect', {'project': project.id, 'id': serie_ids}|merge(app.request.query))} %}
	{% else %}
		{{ parent() }}
	{% endif %}
{% endblock %}